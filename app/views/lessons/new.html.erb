<% content_for(:description) do %>
Moduel de prise de réservations. Offrez la possibilité à vos clients d'effectuer des stages ou des visites de votre atelier.
<% end %>
<% content_for(:title_tag) do %>
  Les <%="#{ENV['MODEL']} de #{ENV['FIRSTNAME'].capitalize} #{ENV['LASTNAME'].capitalize}"%> - Réserver un stage
<% end %>

<div class="container">
  <div class="row">

    <!-- LAPTOP -->
    <div class="hidden-xs col-sm-offset-2 col-sm-8">
      <div class="stage">
        <%= simple_form_for @lesson do |f| %>
          <%= f.input :student, collection: ENV['MINBOOKING'].to_i..ENV['CAPACITY'].to_i, label: "Nombre de participants", selected: ENV['MINBOOKING'].to_i %>
          <label class="control-label select required" for="lesson_student"><abbr title="required">*</abbr> 1er jour de stage</label>
          <div class="form-group">
            <div class='input-group date' id='datetimepicker1'>
              <span class="input-group-addon">
                <span class="fa fa-calendar-o"></span>
              </span>
              <input type='text' class="form-control" name="lesson[start]" placeholder="Cliquez sur l'icône calendrier pour sélectionner une date"/>
            </div>
          </div>
          <%= f.input :duration, collection: [ENV['MINDURATION'],ENV['MAXDURATION']], label: "Durée en jours", selected: ENV['MINDURATION'] %>
          <% if user_signed_in? %>
            <%= f.hidden_field :user_id, value: current_user.id %>
          <% end %>
          <div class="submit-div-stage">
            <%= f.submit "Demande de réservation", class: "btn btn-primary stage-btn" %>
          </div>
        <% end %>
        <div class="wrapper">
          <div class="texte">
            <p><strong>Programme du stage : </strong>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
            <p><strong>Pendant le stage, vous apprenez ou perfectionnez les techniques suivantes: </strong>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis.</p>
            <p> <strong>Hébergements et repas:</strong> Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
            <p><strong>Prix: </strong>Les stages se déroulent sur 2 ou 5 jours, pour 2 à 6 personnes maximum. 2 jours: 150€/pers, 5 jours : 380€/pers. Ces prix ne comprennent pas l'hébergement ni les repas.</p>
            <p><strong>Confirmation: </strong> Quand votre demande de stage sera traitée, vous recevrez une confirmation par mail. Vous devrez ensuite payer les arrhes pour valider définitivement votre participation.</p>
          </div>
        </div>
        </div>
    </div>

    <!-- MOBILE -->
    <div class="hidden-sm hidden-md hidden-lg col-xs-12">
      <div class="stage">
        <%= simple_form_for @lesson do |f| %>
          <%= f.input :student, collection: ENV['MINBOOKING'].to_i..ENV['CAPACITY'].to_i, label: "Nombre de participants", selected: ENV['MINBOOKING'].to_i %>
          <label class="control-label select required" for="lesson_student"><abbr title="required">*</abbr> 1er jour de stage</label>
          <div class="form-group">
            <div class='input-group date' id='datetimepicker1'>
              <span class="input-group-addon">
                <span class="fa fa-calendar-o"></span>
              </span>
              <input type='text' class="form-control" name="lesson[start]" placeholder="JJ.MM.AAAA"/>
            </div>
          </div>
          <%= f.input :duration, collection: [ENV['MINDURATION'],ENV['MAXDURATION']], label: "Durée en jours", selected: ENV['MINDURATION'] %>
          <% if user_signed_in? %>
            <%= f.hidden_field :user_id, value: current_user.id %>
          <% end %>
          <div class="submit-div-stage">
            <%= f.submit "Demande de réservation", class: "btn btn-primary stage-btn" %>
          </div>
        <% end %>
        <div class="wrapper">
          <div class="texte">
            <p><strong>Programme du stage : </strong>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
            <p><strong>Pendant le stage, vous apprenez ou perfectionnez les techniques suivantes: </strong>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis.</p>
            <p> <strong>Hébergements et repas:</strong> Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
            <p><strong>Prix: </strong>Les stages se déroulent sur 2 ou 5 jours, pour 2 à 6 personnes maximum. 2 jours: 150€/pers, 5 jours : 380€/pers. Ces prix ne comprennent pas l'hébergement ni les repas.</p>
            <p><strong>Confirmation: </strong> Quand votre demande de stage sera traitée, vous recevrez une confirmation par mail. Vous devrez ensuite payer les arrhes pour valider définitivement votre participation.</p>
          </div>
        </div>
        </div>
    </div>

  </div>
</div>

<% content_for(:after_js) do %>
  <script>
    $(document).on('ready', function() {

      var confirmed_course_js_format = <%= raw @confirmed_course_js_format%>

      $('#datetimepicker1').datetimepicker({
        disabledDates: <%= raw @disabled_dates%>,
        format: 'DD.MM.YYYY',
        minDate: Date.now(),
        locale: moment.locale('fr')
        }).on('dp.show dp.change dp.update', function () {
          $('.tooltip-inner').remove();
          $('.tooltip-arrow').remove();

          $('[data-day]').each(function(){
            $(this).addClass('current-data-day');
            var currentdate = $(this).data('day');

            confirmed_course_js_format.forEach(function(course) {
              if (currentdate == course) {
                $('.current-data-day').addClass('available-course')
                $('.current-data-day').attr("title", "Cours confirmé, places disponibles");
                $('.current-data-day').data("container", "body");
                $('.current-data-day').tooltip()
              }
            });

            $('.current-data-day').removeClass('current-data-day')
          });
        });
    });
  </script>
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "TouristAttraction",
    "name": "Stage de poterie",
    "description": "Fabriquez vos poteries",
    "url": "https://<%= ENV['APPNAME']%>.herokuapp.com/lessons/new"
  }
  </script>
<% end %>
