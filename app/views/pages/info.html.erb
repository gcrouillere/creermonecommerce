<% content_for(:description) do %>
Vendez vos produits en ligne ! Site de e-commerce configurable. Affichez sur cette page des informations vous concernant : biographie, techniques utilisées.
<% end %>
<% content_for(:title_tag) do %>
  Page bio de votre site de e-commerce
<% end %>

<% avatarpictag = image_tag ENV['AVATAR'], class: "img-avatar" %>
<% avatarpictagmobile = image_tag ENV['AVATAR']  %>
<% citypictag= image_tag ENV['CITY'] %>
<% if user_signed_in? %>
  <% if  current_user.avatarphoto.present? %>
    <% avatarpictag = cl_image_tag current_user.avatarphoto.path, class: "img-avatar" %>
    <% avatarpictagmobile = cl_image_tag(cl_image_path current_user.avatarphoto.path, :width => 200, :height => 200, :crop => :thumb, :gravity => :face) %>
    <% if  current_user.cityphoto.present? %>
      <% citypictag= cl_image_tag current_user.cityphoto.path %>
    <% end %>
  <% end %>
<% end %>

<div class="container">
  <div class="row">

  <!-- LAPTOP -->
    <div class="hidden-xs hidden-sm col-sm-12">
      <div class="wrapper">
        <%= avatarpictag %>
        <div class="texte">
          <h4><%= "#{ENV['FIRSTNAME'].capitalize} #{ENV['LASTNAME'].capitalize}"%></h4>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Maecenas in semper purus, semper hendrerit est. Proin vel ante ac ex iaculis condimentum. Nunc elementum ac tellus non consequat. In tempor est quis arcu hendrerit ultricies. Ut accumsan lacus a nunc mattis, a congue magna eleifend. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
        </div>
      </div>

      <div class="localisation">
        <div class="img-city"><%= citypictag%></div>
        <div id="map"></div>
      </div>

      <%= link_to ceramiques_path, class: "back-in-home" do %>
        <span><i class="fa fa-arrow-right"></i> Liste des <%= ENV['MODEL']%></span>
      <% end %>
    </div>

  <!-- MOBILE -->
   <div class="col-xs-12 hidden-md hidden-lg mobile-info">
      <div class="wrapper-mobile">
        <div class="img-avatar-mobile"><%= avatarpictagmobile %></div>
        <h4><%= "#{ENV['FIRSTNAME'].capitalize} #{ENV['LASTNAME'].capitalize}"%></h4>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Maecenas in semper purus, semper hendrerit est. Proin vel ante ac ex iaculis condimentum. Nunc elementum ac tellus non consequat. In tempor est quis arcu hendrerit ultricies. Ut accumsan lacus a nunc mattis, a congue magna eleifend. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam condimentum dolor ut vulputate tincidunt. Integer et purus et nisl eleifend semper eu sed turpis. Proin dignissim rutrum turpis. Sed quis volutpat dolor, a blandit risus. Phasellus vestibulum sit amet quam vitae tristique. Morbi rutrum leo ut porttitor gravida. Maecenas id vulputate nunc. Pellentesque quis auctor mi.</p>
      </div>

      <div class="localisation-mobile">
        <div class="img-city-mobile"><%= citypictag%></div>
        <div id="map-mobile"></div>
      </div>

      <%= link_to ceramiques_path, class: "back-in-home-mobile" do %>
        <span><i class="fa fa-arrow-right"></i> Liste des <%= ENV['MODEL']%></span>
      <% end %>
    </div>

  </div>
</div>

<% content_for(:after_js) do %>
  <script>
    $(document).ready(function() {

      // LAPTOP GEOLOC - be aware chrome >= 50 requires https for geolocation to work
      if (navigator.geolocation) {
        var handler1 = Gmaps.build('Google');
        handler1.buildMap({ internal: {id: 'map'} }, function(){
          navigator.geolocation.getCurrentPosition(displayOnMapShared);
        });
      } else {
        geolocByIp('map');
      }

      // MOBILE GEOLOC - be aware chrome >= 50 requires https for geolocation to work
      var handler2 = Gmaps.build('Google');
      if (navigator.geolocation) {
        handler2.buildMap({ internal: {id: 'map-mobile'} }, function(){
          navigator.geolocation.getCurrentPosition(displayOnMapShared);
        });
      } else {
        geolocByIp('map-mobile')
      }

      // if user shares location
      function displayOnMapShared(position){
        var marker1 = handler1.addMarker({
          lat: position.coords.latitude,
          lng: position.coords.longitude
        });
        handler1.map.centerOn(marker1);

        var marker2 = handler2.addMarker({
          lat: position.coords.latitude,
          lng: position.coords.longitude
        });
        handler2.map.centerOn(marker2);
      };

      // if not
      function geolocByIp(mapid){
        $.ajax({
          type: 'GET',
          url: 'http://freegeoip.net/json/',
          success: function(response) {
            var map = new google.maps.Map(document.getElementById(mapid), {
              zoom: 7,
              center: {lat: response.latitude, lng: response.longitude}
            });
            marker = new google.maps.Marker({
            position: new google.maps.LatLng(response.latitude,response.longitude),
            map: map
            });
          },
          error: function() {
            console.log('error');
          }
        });
      };

    });
  </script>
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "ArtGallery",
      "name": "Les <%="#{ENV['MODEL']} de #{ENV['FIRSTNAME'].capitalize} #{ENV['LASTNAME'].capitalize}"%>",
      "description": "Online craft store",
      "openingHours": "Mo-Fr 09:00-18:00",
      "telephone": "<%= ENV['TELEPHONE']%>",
      "url": "https://<%= ENV['APPNAME']%>.herokuapp.com/info",
      "image":"https://<%= ENV['APPNAME']%>.herokuapp.com<%= image_path ENV['HOMEPIC']%>"
      "address":"<%= ENV['ADDRESS']%>",
      "priceRange":"20€ à 800€"
    }
  </script>
<% end %>
